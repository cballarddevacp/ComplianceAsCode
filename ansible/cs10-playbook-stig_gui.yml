---
###############################################################################
#
# Ansible Playbook for DRAFT - DISA STIG for Red Hat Enterprise Linux 10
#
# Profile Description:
# This is a draft profile for experimental purposes.
# It is not based on the DISA STIG for RHEL 10, because this one was not available at time of
# the release.
# In addition to being applicable to Red Hat Enterprise Linux 10, DISA recognizes this
# configuration baseline as applicable to the operating system tier of
# Red Hat technologies that are based on Red Hat Enterprise Linux 10.
#
# Profile ID:  xccdf_org.ssgproject.content_profile_stig_gui
# Benchmark ID:  xccdf_org.ssgproject.content_benchmark_RHEL-10
# Benchmark Version:  0.1.73
# XCCDF Version:  1.2
#
# This file can be generated by OpenSCAP using:
# $ oscap xccdf generate fix --profile xccdf_org.ssgproject.content_profile_stig_gui --fix-type ansible ssg-cs10-ds.xml
#
# This Ansible Playbook is generated from an XCCDF profile without preliminary evaluation.
# It attempts to fix every selected rule, even if the system is already compliant.
#
# How to apply this Ansible Playbook:
# $ ansible-playbook -i "localhost," -c local playbook.yml
# $ ansible-playbook -i "192.168.1.155," playbook.yml
# $ ansible-playbook -i inventory.ini playbook.yml
#
###############################################################################


- name: Ansible Playbook for xccdf_org.ssgproject.content_profile_stig_gui
  hosts: all
  vars:
  tasks:
    - name: Ensure sudo is installed
      package:
        name: sudo
        state: present
      when: ansible_virtualization_type not in ["docker", "lxc", "openvz", "podman", "container"]
      tags:
      - NIST-800-53-CM-6(a)
      - PCI-DSSv4-2.2.6
      - enable_strategy
      - low_complexity
      - low_disruption
      - medium_severity
      - no_reboot_needed
      - package_sudo_installed
